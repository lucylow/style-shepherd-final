# Netlify Configuration for Style Shepherd AI Application
# https://docs.netlify.com/configure-builds/file-based-configuration/

[build]
  # Build command for Vite React app
  command = "npm run build"
  
  # Directory where the built site will be published
  publish = "dist"
  
  # Environment variables for build (set in Netlify UI)
  # See NETLIFY_DEPLOYMENT.md for required variables

[build.environment]
  # Node version for build
  NODE_VERSION = "18"
  
  # Build optimization
  NPM_FLAGS = "--legacy-peer-deps"

# Redirect rules for SPA routing
# All non-file requests should go to index.html
# Note: The public/_redirects file handles SPA routing
# API proxy redirects are configured below (uncomment when backend is deployed)

# API proxy rules (if backend is deployed separately)
# Uncomment and update BACKEND_URL when backend is deployed
# [[redirects]]
#   from = "/api/*"
#   to = "https://your-backend-url.com/api/:splat"
#   status = 200
#   force = true
#   headers = {X-From = "Netlify"}

# Headers for security and performance
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"

[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.js"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/*.css"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Netlify Functions (optional - for serverless backend routes)
# Uncomment if you want to use Netlify Functions for some backend logic
# [functions]
#   directory = "netlify/functions"
#   node_bundler = "esbuild"
#   included_files = ["server/**"]

# Edge Functions (optional - for edge computing)
# [edge_functions]
#   directory = "netlify/edge-functions"

# Plugin configuration (optional)
# Uncomment to enable Lighthouse reports on builds
# [[plugins]]
#   package = "@netlify/plugin-lighthouse"
#   [plugins.inputs]
#     output_path = "reports/lighthouse.html"

# Context-specific configurations
[context.production]
  command = "npm run build"

[context.deploy-preview]
  command = "npm run build"

[context.branch-deploy]
  command = "npm run build"

# Development context
[context.dev]
  command = "npm run build:dev"
